package eu.dnetlib.dhp.oa.dedup.local;

import com.google.common.collect.Lists;
import com.kwartile.lib.cc.ConnectedComponent;
import eu.dnetlib.dhp.oa.dedup.DedupUtility;
import eu.dnetlib.dhp.schema.common.EntityType;
import eu.dnetlib.dhp.schema.common.ModelConstants;
import eu.dnetlib.dhp.schema.common.ModelSupport;
import eu.dnetlib.dhp.schema.oaf.OafEntity;
import eu.dnetlib.dhp.schema.oaf.Relation;
import eu.dnetlib.dhp.schema.oaf.Result;
import eu.dnetlib.dhp.schema.oaf.utils.MergeUtils;
import eu.dnetlib.pace.config.DedupConfig;
import eu.dnetlib.pace.model.SparkDeduper;
import eu.dnetlib.pace.model.SparkModel;
import eu.dnetlib.pace.tree.support.TreeProcessor;
import org.apache.spark.api.java.JavaSparkContext;
import org.apache.spark.api.java.function.FlatMapFunction;
import org.apache.spark.api.java.function.FlatMapGroupsFunction;
import org.apache.spark.api.java.function.MapFunction;
import org.apache.spark.sql.*;
import org.apache.spark.sql.catalyst.encoders.RowEncoder;
import org.apache.spark.sql.expressions.UserDefinedFunction;
import org.apache.spark.sql.types.DataTypes;
import org.junit.jupiter.api.*;
import org.junit.jupiter.api.extension.ExtendWith;
import org.junit.platform.commons.util.StringUtils;
import org.mockito.junit.jupiter.MockitoExtension;
import scala.Tuple2;
import scala.Tuple3;
import scala.collection.JavaConversions;
import scala.collection.mutable.WrappedArray;

import java.awt.*;
import java.io.File;
import java.io.IOException;
import java.net.URISyntaxException;
import java.nio.file.Paths;
import java.util.List;
import java.util.*;
import java.util.stream.Stream;

@ExtendWith(MockitoExtension.class)
@TestMethodOrder(MethodOrderer.OrderAnnotation.class)
@TestInstance(TestInstance.Lifecycle.PER_CLASS)
public class SparkDedupLocalTest extends DedupLocalTestUtils {

    static SparkSession spark;
    static DedupConfig config;
    static JavaSparkContext context;

//    final String entitiesPath = Paths
//            .get(Objects.requireNonNull(SparkDedupLocalTest.class.getResource("/eu/dnetlib/dhp/dedup/entities/publication")).toURI())
//            .toFile()
//            .getAbsolutePath();

//    final String dedupConfPath = Paths
//            .get(Objects.requireNonNull(SparkDedupLocalTest.class.getResource("/eu/dnetlib/dhp/dedup/conf/pub.curr.conf.json")).toURI())
//            .toFile()
//            .getAbsolutePath();

    final String entitiesPath = "/Users/miconis/Desktop/pub_to_fix1.json";
    final String dedupConfPath = "/Users/miconis/Desktop/pub.conf.json";

    final static int MAX_ACCEPTANCE_DATE = 20;

    private static SparkDeduper deduper;
    private static SparkModel model;

    public SparkDedupLocalTest() throws URISyntaxException {
    }

    @BeforeAll
    public void setup() throws IOException {

        config = DedupConfig.load(fileToString(dedupConfPath));

        spark = SparkSession
                .builder()
                .appName("Deduplication")
                .master("local[*]")
                .getOrCreate();
        context = JavaSparkContext.fromSparkContext(spark.sparkContext());

        deduper = new SparkDeduper(config);

        model = new SparkModel(config);

    }

    @Test //full deduplication workflow test
    @Disabled
    public void deduplicationTest()  {

        long before_simrels = System.currentTimeMillis();

        Dataset<Row> entities = spark
                .read()
                .textFile(entitiesPath)
                .transform(deduper.model().parseJsonDataset());

        Dataset<Relation> simRels = entities
                .transform(deduper.dedup())
                .distinct()
                .map((MapFunction<Row, Relation>) t ->
                                DedupUtility.createSimRel(t.getStruct(0).getString(0), t.getStruct(0).getString(1), config.getWf().getEntityType()), Encoders.bean(Relation.class)
                );

        long simrels_time = System.currentTimeMillis() - before_simrels;

        long simrels_number = simRels.count();

        long before_mergerels = System.currentTimeMillis();

        UserDefinedFunction hashUDF = functions
                .udf(
                        (String s) -> hash(s), DataTypes.LongType);

        // <hash(id), id>
        Dataset<Row> vertexIdMap = simRels
                .select("source", "target")
                .selectExpr("source as id")
                .union(simRels.selectExpr("target as id"))
                .distinct()
                .withColumn("vertexId", hashUDF.apply(functions.col("id")));

        // transform simrels into pairs of numeric ids
        final Dataset<Row> edges = simRels
                .select("source", "target")
                .withColumn("source", hashUDF.apply(functions.col("source")))
                .withColumn("target", hashUDF.apply(functions.col("target")));

        for(Relation r: simRels.toJavaRDD().collect()) {
            System.out.println(r.getSource() + " ---> " + r.getTarget());
        }


        // resolve connected components
        // ("vertexId", "groupId")
        Dataset<Row> cliques = ConnectedComponent
                .runOnPairs(edges, 50, spark);

        // transform "vertexId" back to its original string value
        // groupId is kept numeric as its string value is not used
        // ("id", "groupId")
        Dataset<Relation> mergeRels = cliques
                .join(vertexIdMap, JavaConversions.asScalaBuffer(Collections.singletonList("vertexId")), "inner")
                .drop("vertexId")
                .distinct()
                .flatMap((FlatMapFunction<Row, Relation>) (Row r) -> {
                    ArrayList<Relation> res = new ArrayList<>();

                    String id = r.getAs("id");
                    String groupId = r.getAs("groupId").toString();
                    res.add(createRel(groupId, id, ModelConstants.MERGES, config));
                    res.add(createRel(id, groupId, ModelConstants.IS_MERGED_IN, config));

                    return res.iterator();
                }, Encoders.bean(Relation.class));


        long mergerels_time = System.currentTimeMillis() - before_mergerels;

        long mergerels_number = mergeRels.count();

        long before_dedupentity = System.currentTimeMillis();

        final Class<OafEntity> clazz = ModelSupport.entityTypes.get(EntityType.valueOf(config.getWf().getSubEntityValue()));
        final Encoder<OafEntity> beanEncoder = Encoders.bean(clazz);
        final Encoder<OafEntity> kryoEncoder = Encoders.kryo(clazz);

        Dataset<Row> kryoEntities = spark.read().schema(Encoders.bean(clazz).schema()).json(entitiesPath).as(beanEncoder).map(
                        (MapFunction<OafEntity, Tuple2<String, OafEntity>>) entity -> {
                            return new Tuple2<>(entity.getId(), entity);
                        },
                        Encoders.tuple(Encoders.STRING(), kryoEncoder))
                .selectExpr("_1 AS id", "_2 AS kryoObject");

        // <source, target>: source is the dedup_id, target is the id of the mergedIn
        Dataset<Row> mergeRelsRow = mergeRels
                .where("relClass == 'merges'")
                .selectExpr("source as dedupId", "target as id");

        Dataset<OafEntity> dedupRecords = mergeRelsRow
                .join(kryoEntities, JavaConversions.asScalaBuffer(Collections.singletonList("id")), "left")
                .select("dedupId", "id", "kryoObject")
                .as(Encoders.tuple(Encoders.STRING(), Encoders.STRING(), kryoEncoder))
                .groupByKey((MapFunction<Tuple3<String, String, OafEntity>, String>) Tuple3::_1, Encoders.STRING())
                .flatMapGroups(
                        (FlatMapGroupsFunction<String, Tuple3<String, String, OafEntity>, OafEntity>) (dedupId, it) -> {
                            if (!it.hasNext())
                                return Collections.emptyIterator();

                            final ArrayList<OafEntity> cliques_ = new ArrayList<>();

                            final ArrayList<String> aliases = new ArrayList<>();

                            final HashSet<String> acceptanceDate = new HashSet<>();

                            while (it.hasNext()) {
                                Tuple3<String, String, OafEntity> t = it.next();
                                OafEntity entity = t._3();

                                if (entity == null) {
                                    aliases.add(t._2());
                                } else {
                                    cliques_.add(entity);

                                    if (acceptanceDate.size() < MAX_ACCEPTANCE_DATE) { //max acceptance date
                                        if (Result.class.isAssignableFrom(entity.getClass())) {
                                            Result result = (Result) entity;
                                            if (result.getDateofacceptance() != null
                                                    && StringUtils.isNotBlank(result.getDateofacceptance().getValue())) {
                                                acceptanceDate.add(result.getDateofacceptance().getValue());
                                            }
                                        }
                                    }
                                }

                            }

                            if (acceptanceDate.size() >= MAX_ACCEPTANCE_DATE || cliques_.isEmpty()) {
                                return Collections.emptyIterator();
                            }

                            OafEntity mergedEntity = MergeUtils.mergeGroup(dedupId, cliques_.iterator());
                            // dedup records do not have date of transformation attribute
                            mergedEntity.setDateoftransformation(null);

                            return Stream
                                    .concat(
                                            Stream
                                                    .of(dedupId)
                                                    .map(id -> DedupLocalTestUtils.createOafEntity(id, mergedEntity, before_dedupentity)),
                                            aliases
                                                    .stream()
                                                    .map(id -> DedupLocalTestUtils.createOafEntity(id, mergedEntity, before_dedupentity)))
                                    .iterator();

                        }, beanEncoder);

        long dedupentity_time = System.currentTimeMillis() - before_dedupentity;

        long dedupentity_number = dedupRecords.count();

        System.out.println("Number of simRels                     : " + simrels_number);
        System.out.println("Number of mergeRels                   : " + mergerels_number);
        System.out.println("Number of dedupEntities               : " + dedupentity_number);
        System.out.println("Total time for simRels creation       : " + simrels_time);
        System.out.println("Total time for mergeRels creation     : " + mergerels_time);
        System.out.println("Total time for dedupEntities creation : " + dedupentity_time);

        showGraph(entities, simRels);

    }

    @Test //test the match between two JSON
    @Disabled
    public void matchTest() {

        String json1 = "{\"geolocation\": [], \"dataInfo\": {\"deletedbyinference\": true, \"provenanceaction\": {\"classid\": \"sysimport:dedup\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"dedup-result-decisiontree-v4\", \"invisible\": false, \"trust\": \"0.8\"}, \"resourcetype\": {\"classid\": \"UNKNOWN\", \"classname\": \"UNKNOWN\", \"schemename\": \"dnet:dataCite_resource\", \"schemeid\": \"dnet:dataCite_resource\"}, \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}, {\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/a5v4-hfh\"}, {\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/cg41-q6u\"}], \"bestaccessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"relevantdate\": [{\"qualifier\": {\"classid\": \"issued\", \"classname\": \"issued\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-05-22\"}, {\"qualifier\": {\"classid\": \"available\", \"classname\": \"available\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-03-31\"}], \"contributor\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"Amunts, Katrin\"}], \"id\": \"50|dedup_wf_002::639e90885a3cccbe75746679ff5492c7\", \"description\": [{\"value\": \"This dataset contains the distinct probabilistic cytoarchitectonic map of Area 5Ci (SPL) in the individual, single subject template of the MNI Colin 27 reference space. As part of the Julich-Brain cytoarchitectonic atlas, the area was identified using classical histological criteria and quantitative cytoarchitectonic analysis on cell-body-stained histological sections of 10 human postmortem brains obtained from the body donor program of the University of D\\\\u00fcsseldorf. The results of the cytoarchitectonic analysis were then mapped to the reference space, where each voxel was assigned the probability to belong to Area 5Ci (SPL). The probability map of Area 5Ci (SPL) is provided in NifTi format for each hemisphere in the reference space. The Julich-Brain atlas relies on a modular, flexible and adaptive framework containing workflows to create the probabilistic brain maps for these structures. Note that methodological improvements and updated probability estimates for new brain structures may in some cases lead to measurable but negligible deviations of existing probability maps, as compared to earlier released datasets. Other available data versions of Area 5Ci (SPL): Scheperjans et al. (2019) [Data set, v8.4] [DOI: 10.25493/SQVP-GK1](https://doi.org/10.25493%2FSQVP-GK1) The most probable delineation of Area 5Ci (SPL) derived from the calculation of a maximum probability map of all currently released Julich-Brain brain structures can be found here: Amunts et al. (2019) [Data set, v1.13] [DOI: 10.25493/Q3ZS-NV6](https://doi.org/10.25493%2FQ3ZS-NV6) Amunts et al. (2019) [Data set, v1.18] [DOI: 10.25493/8EGG-ZAR](https://doi.org/10.25493%2F8EGG-ZAR) Amunts et al. (2020) [Data set, v2.2] [DOI: 10.25493/TAKY-64D](https://doi.org/10.25493%2FTAKY-64D)\"}], \"embargoenddate\": {\"value\": \"2018-03-31\"}, \"lastupdatetimestamp\": 1725556617730, \"author\": [{\"surname\": \"Scheperjans\", \"name\": \"F.\", \"pid\": [], \"rank\": 1, \"affiliation\": [], \"fullname\": \"Scheperjans, F.\"}, {\"surname\": \"Hermann\", \"name\": \"K.\", \"pid\": [], \"rank\": 2, \"affiliation\": [], \"fullname\": \"Hermann, K.\"}, {\"surname\": \"Eickhoff\", \"name\": \"S. B.\", \"pid\": [], \"rank\": 3, \"affiliation\": [], \"fullname\": \"Eickhoff, S. B.\"}, {\"surname\": \"Amunts\", \"name\": \"K.\", \"pid\": [], \"rank\": 4, \"affiliation\": [], \"fullname\": \"Amunts, K.\"}, {\"surname\": \"Schleicher\", \"name\": \"A.\", \"pid\": [], \"rank\": 5, \"affiliation\": [], \"fullname\": \"Schleicher, A.\"}, {\"surname\": \"Hoemke\", \"name\": \"L.\", \"pid\": [], \"rank\": 6, \"affiliation\": [], \"fullname\": \"Hoemke, L.\"}, {\"surname\": \"Mohlberg\", \"name\": \"H.\", \"pid\": [], \"rank\": 7, \"affiliation\": [], \"fullname\": \"Mohlberg, H.\"}, {\"surname\": \"Zilles\", \"name\": \"K.\", \"pid\": [], \"rank\": 8, \"affiliation\": [], \"fullname\": \"Zilles, K.\"}], \"collectedfrom\": [{\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}], \"instance\": [{\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/bq0h-znc\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/a5v4-hfh\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/a5v4-hfh\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/cg41-q6u\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/cg41-q6u\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"Unknown Repository\", \"key\": \"10|openaire____::55045bd2a65019fd8e6741a755395c8c\"}, \"license\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"CC BY NC SA\"}, \"url\": [\"https://doi.org/10.25493/bq0h-znc\"], \"pid\": [], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"alternateIdentifier\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"dateofacceptance\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}, \"accessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"Unknown Repository\", \"key\": \"10|openaire____::55045bd2a65019fd8e6741a755395c8c\"}, \"license\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"CC BY NC SA\"}, \"url\": [\"https://doi.org/10.25493/a5v4-hfh\"], \"pid\": [], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"alternateIdentifier\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/a5v4-hfh\"}], \"dateofacceptance\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}, \"accessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"Unknown Repository\", \"key\": \"10|openaire____::55045bd2a65019fd8e6741a755395c8c\"}, \"license\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"CC BY NC SA\"}, \"url\": [\"https://doi.org/10.25493/cg41-q6u\"], \"pid\": [], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"alternateIdentifier\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/cg41-q6u\"}], \"dateofacceptance\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}, \"accessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}], \"version\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"null\"}, \"storagedate\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"dateofcollection\": \"2024-09-05T17:19:05.982\", \"metaResourceType\": {\"classid\": \"Research Data\", \"classname\": \"Research Data\", \"schemename\": \"openaire::meta_resource_types\", \"schemeid\": \"openaire::meta_resource_types\"}, \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"format\": [], \"subject\": [{\"qualifier\": {\"classid\": \"keyword\", \"classname\": \"keyword\", \"schemename\": \"dnet:subject_classification_typologies\", \"schemeid\": \"dnet:subject_classification_typologies\"}, \"value\": \"Neuroscience\"}], \"coverage\": [], \"externalReference\": [], \"publisher\": {\"value\": \"Human Brain Project Neuroinformatics Platform\"}, \"eoscifguidelines\": [], \"language\": {\"classid\": \"und\", \"classname\": \"Undetermined\", \"schemename\": \"dnet:languages\", \"schemeid\": \"dnet:languages\"}, \"resulttype\": {\"classid\": \"dataset\", \"classname\": \"dataset\", \"schemename\": \"dnet:result_typologies\", \"schemeid\": \"dnet:result_typologies\"}, \"country\": [], \"extraInfo\": [], \"originalId\": [\"50|datacite____::7f98d6c254b0d743c4634412ed94817b\", \"10.25493/bq0h-znc\", \"50|datacite____::4bc8e949f3238624d64980b21cbf8441\", \"10.25493/a5v4-hfh\", \"50|datacite____::098cabeb288616a6a4ae7e950f2a372e\", \"10.25493/cg41-q6u\", \"50|sygma_______::7f98d6c254b0d743c4634412ed94817b\", \"50|sygma_______::4bc8e949f3238624d64980b21cbf8441\", \"50|sygma_______::098cabeb288616a6a4ae7e950f2a372e\"], \"source\": [], \"context\": [{\"dataInfo\": [{\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}], \"id\": \"fet-h2020::flag::85792436c02c::785907\"}, {\"dataInfo\": [{\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}], \"id\": \"fet-h2020::flag::91670347c2a7::945539\"}], \"title\": [{\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5Ci (SPL) (v8.2)\"}, {\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5L (SPL) (v8.2)\"}, {\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5M (SPL) (v8.2)\"}]}";
        String json2 = "{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": true, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"resourcetype\": {\"classid\": \"UNKNOWN\", \"classname\": \"UNKNOWN\", \"schemename\": \"dnet:dataCite_resource\", \"schemeid\": \"dnet:dataCite_resource\"}, \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"bestaccessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"relevantdate\": [{\"qualifier\": {\"classid\": \"issued\", \"classname\": \"issued\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-05-22\"}, {\"qualifier\": {\"classid\": \"available\", \"classname\": \"available\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-03-31\"}], \"collectedfrom\": [{\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}], \"id\": \"50|doi_________::7f98d6c254b0d743c4634412ed94817b\", \"subject\": [{\"qualifier\": {\"classid\": \"keyword\", \"classname\": \"keyword\", \"schemename\": \"dnet:subject_classification_typologies\", \"schemeid\": \"dnet:subject_classification_typologies\"}, \"value\": \"Neuroscience\"}], \"embargoenddate\": {\"value\": \"2018-03-31\"}, \"author\": [{\"surname\": \"Scheperjans\", \"name\": \"F.\", \"pid\": [], \"rank\": 1, \"affiliation\": [], \"fullname\": \"Scheperjans, F.\"}, {\"surname\": \"Hermann\", \"name\": \"K.\", \"pid\": [], \"rank\": 2, \"affiliation\": [], \"fullname\": \"Hermann, K.\"}, {\"surname\": \"Eickhoff\", \"name\": \"S. B.\", \"pid\": [], \"rank\": 3, \"affiliation\": [], \"fullname\": \"Eickhoff, S. B.\"}, {\"surname\": \"Amunts\", \"name\": \"K.\", \"pid\": [], \"rank\": 4, \"affiliation\": [], \"fullname\": \"Amunts, K.\"}, {\"surname\": \"Schleicher\", \"name\": \"A.\", \"pid\": [], \"rank\": 5, \"affiliation\": [], \"fullname\": \"Schleicher, A.\"}, {\"surname\": \"Hoemke\", \"name\": \"L.\", \"pid\": [], \"rank\": 6, \"affiliation\": [], \"fullname\": \"Hoemke, L.\"}, {\"surname\": \"Mohlberg\", \"name\": \"H.\", \"pid\": [], \"rank\": 7, \"affiliation\": [], \"fullname\": \"Mohlberg, H.\"}, {\"surname\": \"Zilles\", \"name\": \"K.\", \"pid\": [], \"rank\": 8, \"affiliation\": [], \"fullname\": \"Zilles, K.\"}], \"description\": [{\"value\": \"This dataset contains the distinct probabilistic cytoarchitectonic map of Area 5Ci (SPL) in the individual, single subject template of the MNI Colin 27 reference space. As part of the Julich-Brain cytoarchitectonic atlas, the area was identified using classical histological criteria and quantitative cytoarchitectonic analysis on cell-body-stained histological sections of 10 human postmortem brains obtained from the body donor program of the University of D\\\\u00fcsseldorf. The results of the cytoarchitectonic analysis were then mapped to the reference space, where each voxel was assigned the probability to belong to Area 5Ci (SPL). The probability map of Area 5Ci (SPL) is provided in NifTi format for each hemisphere in the reference space. The Julich-Brain atlas relies on a modular, flexible and adaptive framework containing workflows to create the probabilistic brain maps for these structures. Note that methodological improvements and updated probability estimates for new brain structures may in some cases lead to measurable but negligible deviations of existing probability maps, as compared to earlier released datasets. Other available data versions of Area 5Ci (SPL): Scheperjans et al. (2019) [Data set, v8.4] [DOI: 10.25493/SQVP-GK1](https://doi.org/10.25493%2FSQVP-GK1) The most probable delineation of Area 5Ci (SPL) derived from the calculation of a maximum probability map of all currently released Julich-Brain brain structures can be found here: Amunts et al. (2019) [Data set, v1.13] [DOI: 10.25493/Q3ZS-NV6](https://doi.org/10.25493%2FQ3ZS-NV6) Amunts et al. (2019) [Data set, v1.18] [DOI: 10.25493/8EGG-ZAR](https://doi.org/10.25493%2F8EGG-ZAR) Amunts et al. (2020) [Data set, v2.2] [DOI: 10.25493/TAKY-64D](https://doi.org/10.25493%2FTAKY-64D)\"}], \"instance\": [{\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/bq0h-znc\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}], \"dateofcollection\": \"2021-07-20T01:01:03+0000\", \"metaResourceType\": {\"classid\": \"Research Data\", \"classname\": \"Research Data\", \"schemename\": \"openaire::meta_resource_types\", \"schemeid\": \"openaire::meta_resource_types\"}, \"dateoftransformation\": \"2021-07-20T01:01:03+0000\", \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"publisher\": {\"value\": \"Human Brain Project Neuroinformatics Platform\"}, \"language\": {\"classid\": \"und\", \"classname\": \"Undetermined\", \"schemename\": \"dnet:languages\", \"schemeid\": \"dnet:languages\"}, \"resulttype\": {\"classid\": \"dataset\", \"classname\": \"dataset\", \"schemename\": \"dnet:result_typologies\", \"schemeid\": \"dnet:result_typologies\"}, \"title\": [{\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5Ci (SPL) (v8.2)\"}], \"originalId\": [\"50|datacite____::7f98d6c254b0d743c4634412ed94817b\", \"10.25493/bq0h-znc\"], \"context\": []}";

        Row a = model.rowFromJson(json1);
        Row b = model.rowFromJson(json2);

        boolean result = new TreeProcessor(config).compare(a,b);

        System.out.println("Tree Processor Result = " + result);

    }

    @Test //test the keys between two JSON
    @Disabled
    public void blockingTest() {

        String json1 = "{\"geolocation\": [], \"dataInfo\": {\"deletedbyinference\": true, \"provenanceaction\": {\"classid\": \"sysimport:dedup\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"dedup-result-decisiontree-v4\", \"invisible\": false, \"trust\": \"0.8\"}, \"resourcetype\": {\"classid\": \"UNKNOWN\", \"classname\": \"UNKNOWN\", \"schemename\": \"dnet:dataCite_resource\", \"schemeid\": \"dnet:dataCite_resource\"}, \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}, {\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/a5v4-hfh\"}, {\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/cg41-q6u\"}], \"bestaccessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"relevantdate\": [{\"qualifier\": {\"classid\": \"issued\", \"classname\": \"issued\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-05-22\"}, {\"qualifier\": {\"classid\": \"available\", \"classname\": \"available\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-03-31\"}], \"contributor\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"Amunts, Katrin\"}], \"id\": \"50|dedup_wf_002::639e90885a3cccbe75746679ff5492c7\", \"description\": [{\"value\": \"This dataset contains the distinct probabilistic cytoarchitectonic map of Area 5Ci (SPL) in the individual, single subject template of the MNI Colin 27 reference space. As part of the Julich-Brain cytoarchitectonic atlas, the area was identified using classical histological criteria and quantitative cytoarchitectonic analysis on cell-body-stained histological sections of 10 human postmortem brains obtained from the body donor program of the University of D\\\\u00fcsseldorf. The results of the cytoarchitectonic analysis were then mapped to the reference space, where each voxel was assigned the probability to belong to Area 5Ci (SPL). The probability map of Area 5Ci (SPL) is provided in NifTi format for each hemisphere in the reference space. The Julich-Brain atlas relies on a modular, flexible and adaptive framework containing workflows to create the probabilistic brain maps for these structures. Note that methodological improvements and updated probability estimates for new brain structures may in some cases lead to measurable but negligible deviations of existing probability maps, as compared to earlier released datasets. Other available data versions of Area 5Ci (SPL): Scheperjans et al. (2019) [Data set, v8.4] [DOI: 10.25493/SQVP-GK1](https://doi.org/10.25493%2FSQVP-GK1) The most probable delineation of Area 5Ci (SPL) derived from the calculation of a maximum probability map of all currently released Julich-Brain brain structures can be found here: Amunts et al. (2019) [Data set, v1.13] [DOI: 10.25493/Q3ZS-NV6](https://doi.org/10.25493%2FQ3ZS-NV6) Amunts et al. (2019) [Data set, v1.18] [DOI: 10.25493/8EGG-ZAR](https://doi.org/10.25493%2F8EGG-ZAR) Amunts et al. (2020) [Data set, v2.2] [DOI: 10.25493/TAKY-64D](https://doi.org/10.25493%2FTAKY-64D)\"}], \"embargoenddate\": {\"value\": \"2018-03-31\"}, \"lastupdatetimestamp\": 1725556617730, \"author\": [{\"surname\": \"Scheperjans\", \"name\": \"F.\", \"pid\": [], \"rank\": 1, \"affiliation\": [], \"fullname\": \"Scheperjans, F.\"}, {\"surname\": \"Hermann\", \"name\": \"K.\", \"pid\": [], \"rank\": 2, \"affiliation\": [], \"fullname\": \"Hermann, K.\"}, {\"surname\": \"Eickhoff\", \"name\": \"S. B.\", \"pid\": [], \"rank\": 3, \"affiliation\": [], \"fullname\": \"Eickhoff, S. B.\"}, {\"surname\": \"Amunts\", \"name\": \"K.\", \"pid\": [], \"rank\": 4, \"affiliation\": [], \"fullname\": \"Amunts, K.\"}, {\"surname\": \"Schleicher\", \"name\": \"A.\", \"pid\": [], \"rank\": 5, \"affiliation\": [], \"fullname\": \"Schleicher, A.\"}, {\"surname\": \"Hoemke\", \"name\": \"L.\", \"pid\": [], \"rank\": 6, \"affiliation\": [], \"fullname\": \"Hoemke, L.\"}, {\"surname\": \"Mohlberg\", \"name\": \"H.\", \"pid\": [], \"rank\": 7, \"affiliation\": [], \"fullname\": \"Mohlberg, H.\"}, {\"surname\": \"Zilles\", \"name\": \"K.\", \"pid\": [], \"rank\": 8, \"affiliation\": [], \"fullname\": \"Zilles, K.\"}], \"collectedfrom\": [{\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}], \"instance\": [{\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/bq0h-znc\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/a5v4-hfh\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/a5v4-hfh\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/cg41-q6u\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/cg41-q6u\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"Unknown Repository\", \"key\": \"10|openaire____::55045bd2a65019fd8e6741a755395c8c\"}, \"license\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"CC BY NC SA\"}, \"url\": [\"https://doi.org/10.25493/bq0h-znc\"], \"pid\": [], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"alternateIdentifier\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"dateofacceptance\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}, \"accessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"Unknown Repository\", \"key\": \"10|openaire____::55045bd2a65019fd8e6741a755395c8c\"}, \"license\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"CC BY NC SA\"}, \"url\": [\"https://doi.org/10.25493/a5v4-hfh\"], \"pid\": [], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"alternateIdentifier\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/a5v4-hfh\"}], \"dateofacceptance\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}, \"accessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}, {\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"Unknown Repository\", \"key\": \"10|openaire____::55045bd2a65019fd8e6741a755395c8c\"}, \"license\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"CC BY NC SA\"}, \"url\": [\"https://doi.org/10.25493/cg41-q6u\"], \"pid\": [], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"alternateIdentifier\": [{\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/cg41-q6u\"}], \"dateofacceptance\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Sygma\", \"key\": \"10|openaire____::a8db6f6b2ce4fe72e8b2314a9a93e7d9\"}, \"accessright\": {\"classid\": \"OPEN\", \"classname\": \"Open Access\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}], \"version\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"null\"}, \"storagedate\": {\"dataInfo\": {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"sysimport:crosswalk:datasetarchive\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": false, \"inferenceprovenance\": \"\", \"invisible\": false, \"trust\": \"0.9\"}, \"value\": \"2018-05-22\"}, \"dateofcollection\": \"2024-09-05T17:19:05.982\", \"metaResourceType\": {\"classid\": \"Research Data\", \"classname\": \"Research Data\", \"schemename\": \"openaire::meta_resource_types\", \"schemeid\": \"openaire::meta_resource_types\"}, \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"format\": [], \"subject\": [{\"qualifier\": {\"classid\": \"keyword\", \"classname\": \"keyword\", \"schemename\": \"dnet:subject_classification_typologies\", \"schemeid\": \"dnet:subject_classification_typologies\"}, \"value\": \"Neuroscience\"}], \"coverage\": [], \"externalReference\": [], \"publisher\": {\"value\": \"Human Brain Project Neuroinformatics Platform\"}, \"eoscifguidelines\": [], \"language\": {\"classid\": \"und\", \"classname\": \"Undetermined\", \"schemename\": \"dnet:languages\", \"schemeid\": \"dnet:languages\"}, \"resulttype\": {\"classid\": \"dataset\", \"classname\": \"dataset\", \"schemename\": \"dnet:result_typologies\", \"schemeid\": \"dnet:result_typologies\"}, \"country\": [], \"extraInfo\": [], \"originalId\": [\"50|datacite____::7f98d6c254b0d743c4634412ed94817b\", \"10.25493/bq0h-znc\", \"50|datacite____::4bc8e949f3238624d64980b21cbf8441\", \"10.25493/a5v4-hfh\", \"50|datacite____::098cabeb288616a6a4ae7e950f2a372e\", \"10.25493/cg41-q6u\", \"50|sygma_______::7f98d6c254b0d743c4634412ed94817b\", \"50|sygma_______::4bc8e949f3238624d64980b21cbf8441\", \"50|sygma_______::098cabeb288616a6a4ae7e950f2a372e\"], \"source\": [], \"context\": [{\"dataInfo\": [{\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}], \"id\": \"fet-h2020::flag::85792436c02c::785907\"}, {\"dataInfo\": [{\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}, {\"deletedbyinference\": false, \"provenanceaction\": {\"classid\": \"iis\", \"classname\": \"Inferred by OpenAIRE\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}, \"inferred\": true, \"inferenceprovenance\": \"iis::document_referencedProjects\", \"invisible\": false, \"trust\": \"0.9\"}], \"id\": \"fet-h2020::flag::91670347c2a7::945539\"}], \"title\": [{\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5Ci (SPL) (v8.2)\"}, {\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5L (SPL) (v8.2)\"}, {\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5M (SPL) (v8.2)\"}]}";
        String json2 = "{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": true, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"resourcetype\": {\"classid\": \"UNKNOWN\", \"classname\": \"UNKNOWN\", \"schemename\": \"dnet:dataCite_resource\", \"schemeid\": \"dnet:dataCite_resource\"}, \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"bestaccessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"relevantdate\": [{\"qualifier\": {\"classid\": \"issued\", \"classname\": \"issued\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-05-22\"}, {\"qualifier\": {\"classid\": \"available\", \"classname\": \"available\", \"schemename\": \"dnet:dataCite_date\", \"schemeid\": \"dnet:dataCite_date\"}, \"value\": \"2018-03-31\"}], \"collectedfrom\": [{\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}], \"id\": \"50|doi_________::7f98d6c254b0d743c4634412ed94817b\", \"subject\": [{\"qualifier\": {\"classid\": \"keyword\", \"classname\": \"keyword\", \"schemename\": \"dnet:subject_classification_typologies\", \"schemeid\": \"dnet:subject_classification_typologies\"}, \"value\": \"Neuroscience\"}], \"embargoenddate\": {\"value\": \"2018-03-31\"}, \"author\": [{\"surname\": \"Scheperjans\", \"name\": \"F.\", \"pid\": [], \"rank\": 1, \"affiliation\": [], \"fullname\": \"Scheperjans, F.\"}, {\"surname\": \"Hermann\", \"name\": \"K.\", \"pid\": [], \"rank\": 2, \"affiliation\": [], \"fullname\": \"Hermann, K.\"}, {\"surname\": \"Eickhoff\", \"name\": \"S. B.\", \"pid\": [], \"rank\": 3, \"affiliation\": [], \"fullname\": \"Eickhoff, S. B.\"}, {\"surname\": \"Amunts\", \"name\": \"K.\", \"pid\": [], \"rank\": 4, \"affiliation\": [], \"fullname\": \"Amunts, K.\"}, {\"surname\": \"Schleicher\", \"name\": \"A.\", \"pid\": [], \"rank\": 5, \"affiliation\": [], \"fullname\": \"Schleicher, A.\"}, {\"surname\": \"Hoemke\", \"name\": \"L.\", \"pid\": [], \"rank\": 6, \"affiliation\": [], \"fullname\": \"Hoemke, L.\"}, {\"surname\": \"Mohlberg\", \"name\": \"H.\", \"pid\": [], \"rank\": 7, \"affiliation\": [], \"fullname\": \"Mohlberg, H.\"}, {\"surname\": \"Zilles\", \"name\": \"K.\", \"pid\": [], \"rank\": 8, \"affiliation\": [], \"fullname\": \"Zilles, K.\"}], \"description\": [{\"value\": \"This dataset contains the distinct probabilistic cytoarchitectonic map of Area 5Ci (SPL) in the individual, single subject template of the MNI Colin 27 reference space. As part of the Julich-Brain cytoarchitectonic atlas, the area was identified using classical histological criteria and quantitative cytoarchitectonic analysis on cell-body-stained histological sections of 10 human postmortem brains obtained from the body donor program of the University of D\\\\u00fcsseldorf. The results of the cytoarchitectonic analysis were then mapped to the reference space, where each voxel was assigned the probability to belong to Area 5Ci (SPL). The probability map of Area 5Ci (SPL) is provided in NifTi format for each hemisphere in the reference space. The Julich-Brain atlas relies on a modular, flexible and adaptive framework containing workflows to create the probabilistic brain maps for these structures. Note that methodological improvements and updated probability estimates for new brain structures may in some cases lead to measurable but negligible deviations of existing probability maps, as compared to earlier released datasets. Other available data versions of Area 5Ci (SPL): Scheperjans et al. (2019) [Data set, v8.4] [DOI: 10.25493/SQVP-GK1](https://doi.org/10.25493%2FSQVP-GK1) The most probable delineation of Area 5Ci (SPL) derived from the calculation of a maximum probability map of all currently released Julich-Brain brain structures can be found here: Amunts et al. (2019) [Data set, v1.13] [DOI: 10.25493/Q3ZS-NV6](https://doi.org/10.25493%2FQ3ZS-NV6) Amunts et al. (2019) [Data set, v1.18] [DOI: 10.25493/8EGG-ZAR](https://doi.org/10.25493%2F8EGG-ZAR) Amunts et al. (2020) [Data set, v2.2] [DOI: 10.25493/TAKY-64D](https://doi.org/10.25493%2FTAKY-64D)\"}], \"instance\": [{\"refereed\": {\"classid\": \"0002\", \"classname\": \"nonPeerReviewed\", \"schemename\": \"dnet:review_levels\", \"schemeid\": \"dnet:review_levels\"}, \"hostedby\": {\"value\": \"EBRAINS\", \"key\": \"10|fairsharing_::2ef3e50fd7c1091dda165f25be7f64fd\"}, \"license\": {\"value\": \"CC BY NC SA\"}, \"url\": [\"https://dx.doi.org/10.25493/bq0h-znc\"], \"pid\": [{\"dataInfo\": {\"invisible\": false, \"trust\": \"0.9\", \"deletedbyinference\": false, \"inferred\": false, \"provenanceaction\": {\"classid\": \"sysimport:actionset\", \"classname\": \"Harvested\", \"schemename\": \"dnet:provenanceActions\", \"schemeid\": \"dnet:provenanceActions\"}}, \"qualifier\": {\"classid\": \"doi\", \"classname\": \"Digital Object Identifier\", \"schemename\": \"dnet:pid_types\", \"schemeid\": \"dnet:pid_types\"}, \"value\": \"10.25493/bq0h-znc\"}], \"instanceTypeMapping\": [{\"originalType\": \"Dataset\", \"typeLabel\": \"dataset\", \"vocabularyName\": \"openaire::coar_resource_types_3_1\", \"typeCode\": \"http://purl.org/coar/resource_type/c_ddb1\"}], \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"collectedfrom\": {\"value\": \"Datacite\", \"key\": \"10|openaire____::9e3be59865b2c1c335d32dae2fe7b254\"}, \"accessright\": {\"classid\": \"UNKNOWN\", \"classname\": \"not available\", \"schemename\": \"dnet:access_modes\", \"schemeid\": \"dnet:access_modes\"}, \"instancetype\": {\"classid\": \"0021\", \"classname\": \"Dataset\", \"schemename\": \"dnet:publication_resource\", \"schemeid\": \"dnet:publication_resource\"}}], \"dateofcollection\": \"2021-07-20T01:01:03+0000\", \"metaResourceType\": {\"classid\": \"Research Data\", \"classname\": \"Research Data\", \"schemename\": \"openaire::meta_resource_types\", \"schemeid\": \"openaire::meta_resource_types\"}, \"dateoftransformation\": \"2021-07-20T01:01:03+0000\", \"dateofacceptance\": {\"value\": \"2018-05-22\"}, \"publisher\": {\"value\": \"Human Brain Project Neuroinformatics Platform\"}, \"language\": {\"classid\": \"und\", \"classname\": \"Undetermined\", \"schemename\": \"dnet:languages\", \"schemeid\": \"dnet:languages\"}, \"resulttype\": {\"classid\": \"dataset\", \"classname\": \"dataset\", \"schemename\": \"dnet:result_typologies\", \"schemeid\": \"dnet:result_typologies\"}, \"title\": [{\"qualifier\": {\"classid\": \"main title\", \"classname\": \"main title\", \"schemename\": \"dnet:dataCite_title\", \"schemeid\": \"dnet:dataCite_title\"}, \"value\": \"Probabilistic cytoarchitectonic map of Area 5Ci (SPL) (v8.2)\"}], \"originalId\": [\"50|datacite____::7f98d6c254b0d743c4634412ed94817b\", \"10.25493/bq0h-znc\"], \"context\": []}";

        Row a = model.rowFromJson(json1);
        Row b = model.rowFromJson(json2);

        List<Row> rows = Lists.newArrayList(a, b);

        Dataset<Row> rowsDS = spark.createDataset(rows, RowEncoder.apply(model.schema()))
                .transform(deduper.filterAndCleanup())
                .transform(deduper.generateClustersWithCollect());

        for (Row r: rowsDS.toJavaRDD().collect()) {
            System.out.println("block key = " + r.get(0));
            System.out.println("block size = " + r.get(1));
        }

    }

    private void showGraph(Dataset<Row> entities, Dataset<Relation> simRels) {
        try {
            prepareGraphParams(
                    entities,
                    simRels,
                    "/tmp/graph.html",
                    Paths.get(Objects.requireNonNull(SparkDedupLocalTest.class.getResource("/eu/dnetlib/dhp/dedup/visualization_tools/graph_template.html")).toURI()).toFile().getAbsolutePath());
            Desktop.getDesktop().browse(new File("/tmp/graph.html").toURI());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}